<!--
SPDX-FileCopyrightText: 2021 City of Tampere

SPDX-License-Identifier: LGPL-2.1-or-later
-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8"/>
    <style th:replace="~{tampere/shared/common.html :: css}"></style>
    <style th:replace="~{tampere/fee-decision/fee-decision-css.html}"></style>
</head>

<body>

<header th:replace="~{ tampere/shared/common :: feeDecisionHeader}"></header>

<div class="page first-page">
    <div class="address">
        <div th:text="${headFullName}"></div>
        <div th:text="${sendAddress.row1}"></div>
        <div th:text="${sendAddress.row2}"></div>
        <div th:if="${not #strings.isEmpty(sendAddress.row3)}" th:text="${sendAddress.row3}"></div>
    </div>

    <h1 th:if="${isReliefDecision}" th:text="#{text.relief.title}"></h1>
    <h1 th:unless="${isReliefDecision}" th:text="#{text.title}"></h1>


    <p th:if="${decisionType == 'RELIEF_ACCEPTED'}" th:text="#{text.relief.accepted}"></p>
    <p th:if="${decisionType == 'RELIEF_PARTLY_ACCEPTED'}" th:text="#{text.relief.partlyAccepted}"></p>
    <p th:if="${decisionType == 'RELIEF_REJECTED'}" th:text="#{text.relief.rejected}"></p>

    <p th:if="${isReliefDecision}"
       th:text="${not #strings.isEmpty(validTo)} ? #{text.relief.decision_retroactive(${totalFee}, ${validFor})} : #{text.relief.decision(${totalFee}, ${validFrom})}"></p>
    <p th:unless="${isReliefDecision}"
       th:text="${not #strings.isEmpty(validTo)} ? #{text.decision_retroactive(${totalFee}, ${validFor})} : #{text.decision(${totalFee}, ${validFrom})}"></p>

    <p th:text="#{text.table.intro}"></p>

    <table>
        <tbody>
        <tr>
            <td th:text="${headFullName}"></td>

            <td class="text-right" th:switch="${headIncomeEffect}">
                <span th:case="'MAX_FEE_ACCEPTED'" th:text="#{text.income.max_fee_accepted}"></span>
                <span th:case="'INCOMPLETE'" th:text="#{text.income.incomplete}"></span>
                <span th:case="'INCOME'" th:text="${headIncomeTotal}"></span>
                <span th:case="'NOT_AVAILABLE'" th:text="#{text.income.not_available}"></span>
            </td>
        </tr>
        <tr th:if="${hasPartner}">
            <td th:text="${partnerFullName}"></td>
            <td class="text-right" th:switch="${partnerIncomeEffect}">
                <span th:case="'MAX_FEE_ACCEPTED'" th:text="#{text.income.max_fee_accepted}"></span>
                <span th:case="'INCOMPLETE'" th:text="#{text.income.incomplete}"></span>
                <span th:case="'INCOME'" th:text="${partnerIncomeTotal}"></span>
                <span th:case="'NOT_AVAILABLE'" th:text="#{text.income.not_available}"></span>
            </td>
        </tr>
        <tr th:if="${showTotalIncome}">
            <td th:text="#{text.table.combined}"></td>
            <td class="text-right" th:text="${totalIncome}"></td>
        </tr>
        <tr th:if="${showTotalIncome}">
            <td th:text="#{text.pricingMinThreshold(${familySize})}"></td>
            <td class="text-right" th:text="${pricingMinThreshold}"></td>
        </tr>
        </tbody>
    </table>

    <p th:text="#{text.feePercent(${feePercent})}"></p>

    <table>
        <tbody th:each="part: ${parts}">
        <tr>
            <td th:text="${part.childName}"></td>
            <td th:text="${part.serviceNeedDescription}"></td>
            <td class="text-right" th:text="${part.feeFormatted}"></td>
        </tr>
        <tr th:each="alteration: ${part.feeAlterations}">
            <td></td>
            <td th:switch="${alteration.first.name}">
                <span th:case="'DISCOUNT'" th:text="#{text.feeAlterationType.DISCOUNT}"></span>
                <span th:case="'INCREASE'" th:text="#{text.feeAlterationType.INCREASE}"></span>
                <span th:case="'RELIEF'" th:text="#{text.feeAlterationType.RELIEF}"></span>
            </td>
            <td class="text-right" th:text="${alteration.second}"></td>
        </tr>
        <tr>
            <td></td>
            <td th:text="#{text.table.finalFee}"></td>
            <td class="text-right" th:text="${part.finalFeeFormatted}"></td>
        </tr>
        </tbody>
        <tbody>
        <tr>
            <td></td>
            <td th:text="#{text.table.combined}"></td>
            <td class="text-right" th:text="${totalFee}"></td>
        </tr>
        </tbody>
    </table>

    <p th:text="#{text.reference}"></p>
    <a th:href="#{text.referenceUrl}" th:text="#{text.referenceUrl}"></a>


</div>

<div class="page">

    <div class="legal-content">
        <p th:text="#{text.legal.p1}"></p>
        <p th:text="#{text.legal.p2}"></p>
        <p th:text="#{text.legal.p4}"></p>
        <p th:text="#{text.legal.p5}"></p>
    </div>

    <div class="document-signed-details">
        <p>
            <span th:text="#{text.legal.p8}"></span>
            <span th:text="${approvedAt}"></span>
        </p>
        <div th:text="#{text.legal.p9}"></div>
        <div>
            <span th:text="${approverLastName}"></span>,
            <span th:text="${approverFirstName}"></span>
        </div>
        <div th:text="#{text.legal.p16}"></div>
        <div th:text="#{text.legal.p10}"></div>
        <div th:text="#{text.legal.p11}"></div>
        <div th:text="#{text.legal.p12}"></div>
        <div th:text="#{text.legal.p13}"></div>
        <div th:text="#{text.legal.p14}"></div>
        <div th:text="#{text.legal.p15}"></div>
    </div>

</div>

<div class="page last-page">
    <div th:replace="~{tampere/shared/daycare-correction :: correction}"></div>
</div>


</body>
</html>
